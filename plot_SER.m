clear;
rhot = 0;
rhol = 0;
PGdb =  [0 -0.9 -1.7 -2.6 -3.5 -4.3 -5.2 -6.1 -6.9 -7.8 -4.7 -7.3 -9.9 -12.5 -13.7 -18 -22.4 -26.7];
xi = 0.5;
pAdb = 35;
pEdb = linspace(-4,6,11);
Me = [2 4];

for i = 1: length(Me)
    for j = 1: length(pEdb)
        [SER1(i,j)] = SEP_TRP2P_analytical (rhot,rhol,PGdb,xi, Me(i), pEdb(j), pAdb);
        [SER2(i,j)] = SEP_TRP2P (rhot,rhol,PGdb,xi, Me(i), pEdb(j), pAdb);
        [SER3(i,j)] = SEP_nonTR (rhot,rhol,PGdb,xi, Me(i), pEdb(j), pAdb);
        
        %[SER3(i,j)] = SEP_TRP2P_analytical (rhot,rhol,PGdb,xi(j), Me(i), pEdb, pAdb);

        %[SER4(i,j)] = SEP_TRP2P (rhot,rhol,PGdb,xi(j), Me(i), pEdb, pAdb);
    end
end

%SER1(1,:) = [5.21219608839922e-06 3.50198576494844e-05 0.000179155551406613 0.000716472211408946 0.00230467925814778 0.00613613947824944 0.0138957781484974 0.0274409593328852 0.0483128451399917 0.0773078927535289 0.114288653630448];
%SER1(2,:) = [0.407766576696405 0.261569964943210 0.130127455148737 0.0445564063692275 0.00938357141896609 0.00121476098350884 0.000120825609928426 1.37161284372828e-05 2.46275705079672e-06 7.63945212724351e-07];

%SER2(1,:) = [0.411110000000000 0.267130000000000 0.136870000000000 0.0529300000000000 0.0135600000000000 0.00291000000000000 0.000550000000000000 0.000170000000000000 6.02000000000000e-05 3.00000000000000e-05];
%SER2(2,:) = [0.407670000000000 0.263880000000000 0.131700000000000 0.0437400000000000 0.00907000000000000 0.00125000000000000 0.000121000000000000 1.30000000000000e-05 2.4e-06 7.4e-07];

%SER3(1,:) = [0.507958526711190 0.372654060175127 0.229511461305930 0.109804805946830 0.0378021980883205 0.00927196829682151 0.00186112866762351 0.000400047290195718 0.000116840583378366 5.00436534344794e-05];
%SER3(2,:) = [0.506529855503154 0.369500439582393 0.223802869572383 0.102110435705120 0.0310054411584019 0.00569496504287445 0.000665977783591232 6.58702125610032e-05 8.25147225171314e-06 1.71498481323178e-06];

%SER4(1,:) = [0.509100000000000 0.372870000000000 0.227580000000000 0.108440000000000 0.0369500000000000 0.00945000000000000 0.00208000000000000 0.000410000000000000 0.000114000000000000 5.00000000000000e-05];
%SER4(2,:) = [0.507170000000000 0.370860000000000 0.225730000000000 0.101620000000000 0.0311300000000000 0.00599000000000000 0.000610000000000000 6.00000000000000e-05 8.75147225171314e-06 1.75498481323178e-06];

figure(2); clf;
semilogy(pEdb,SER1(1,:),'-k',pEdb,SER2(1,:),'ok',pEdb,SER3(1,:),'--k',        pEdb,SER1(2,:),'-r',pEdb,SER2(2,:),'or',pEdb,SER3(2,:),'--r')
%semilogy(pEdb,SER1(1,:),'-k',pEdb,SER2(1,:),'ok',        pEdb,SER1(2,:),'-k',pEdb,SER2(2,:),'ok')
xlabel('p_{E,n} (dB)')
ylabel('SER')
legend('Analytical, with TR','Simulation, with TR','Simulation, w/o TR',1 )


